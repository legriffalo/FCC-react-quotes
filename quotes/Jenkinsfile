pipeline {
    agent any

    stages {
        stage('Build (if needed)') {
            steps {
                // Add build steps if your project requires them (e.g., npm install, npm build)
                // For a static site, this stage might be skipped.
                bat 'echo "Building (if necessary)..."'
                dir('quotes'){
                bat 'npm install'
                bat 'npm run build'
                }
            }
        }
        stage('Deploy to Render') {
            steps {
                script {
                    // **Method 1: Using Render Deploy Hook (Recommended)**

                    withCredentials([string(credentialsId: 'RENDER_DEPLOY_HOOK_URL', variable: 'DEPLOY_HOOK')]) {
                    def deployHookUrl = "${DEPLOY_HOOK}" // Retrieve the credential value into a Groovy variable

                    try {
                        bat "curl -X POST \"${deployHookUrl}\""
                        echo "Successfully triggered Render deployment via Deploy Hook."
                    } catch (Exception e) {
                        error "Failed to trigger Render deployment: ${e.getMessage()}"
                    }

                   }
                }
            }
        }
    }
}